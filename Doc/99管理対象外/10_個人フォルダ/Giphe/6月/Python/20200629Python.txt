Python作業メモ


■エラー


■ショートカット
エラー①ホーム選択時、キーが存在しない
acquired_rank = self.getRaceRank(self.raceRoot[self.iid]['r_rank'])
KeyError: 'I001'
→ツリー選択時 try exceptで判定→エラーの場合は選択不可、進化元新規の場合は選択不可　OK



■課題

→複数登録はexecutemanyで登録、DBアクセスを減らそう
・種族進化実装→rece_id、親コードを設定する。最終進化は親コード0

→with recursive～　種族は再帰SQLを使用－完了済み

課題③：キャラクタ登録→課題④
→ツリー表示完了　OK

課題④：total_pattern表示最小値が１になってしまっている。最小値0に修正。OK
・新規の場合

・編集の場合
編集前のステータスを表示する必要がある

課題⑤：
・コンボボックス選択イベント実装　OK（できてたｗ）※
・Dtoに選択した種族のステータスをセット：set_select_race　OK

※選択可能種族はすでに存在する進化先を選べないようにする必要あり
※選択後再びSelectしているので無駄にDB負荷がかかってしまっている（ぶっちゃツリーデータで取得済みなので必要ない）
※

→Insert：進化先（コンボボックスの値が存在しない場合→Insert中断）
　→Insertの場合進化先は存在しないので、最終進化として登録する
　→名前、ランク被りは重複エラーとする→登録チェックを実装（課題⑦）
→Update：進化前（コンボボックス有りの場合→Update)　NGコンボボックス選択後
　※Updateの場合ほかのツリーも予期せず更新してしまう可能性がある（仕様通り）
　

2020/06/29 SQL詳細は次回

課題⑥：
・OK/Cancelポップアップクラス作成→baseにとりあえずまとめる

課題⑦：
・名前とランクで重複チェックを実施する

課題⑧：
・子種族のアップデートどうする→Insertしたデータのrace_idを取得して子種族のparent_idに格納する
→Insertの戻り値を取得したい

■メモ
・種族作成画面
→クラスRaceTree
→ホームを選択で最初の種族
→複数の進化元がある場合→種族の重複を防ぐ必要があるコンボボックス
★実装
①進化先が1－3まですべて埋まっている場合→新規作成ラジオボタン選択不可。可否イベント実装　OK
②新規登録の場合選択ツリーの種族は更新対象→更新対象種族の進化先を登録
（1,2が埋まっていれば次の番号に格納される）　OK
③ツリーが多対多（進化元、進化先複数なので）ツリー上で重複しないように表示することは可能なのかどうか？
→iidをうまく使えば可能なのでは？→NG（現状維持）

次回→コンボボックスの中身から

ex.
①アングロサクソン→ヒューマン
②ホモサピエンス→ヒューマン
の場合
①は新規登録race_name, 進化LEVEL,上昇値（手動orランダム）の入力
②は更新コンボボックスから進化先を選択して登録（手動)


→クラスRaceSpread


■進捗06/22
・ツリービュー部、スプレッド部
→ツリー作成

■次回
・内部イベント作成

